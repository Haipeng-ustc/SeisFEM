void shape_q9(double r, double s, double t[], double dtdr[], double dtds[] )

/*
*****************************************************************************

 SHAPE_Q9 evaluates shape functions for a 9 node reference quadrilateral.

  Reference Element Q9:

    |
    1  4--7--3
    |  |     |
    |  |     |
    S  8  9  6
    |  |     |
    |  |     |
    0  1--5--2
    |
    +--0--R--1-->

*/

{
	t[0] =    4.000 *     ( r - 1.000 ) *     ( r - 0.500 ) *     ( s - 1.000 ) * ( s - 0.500 );
  	t[1] =    4.000 * r * ( r - 0.500 ) *     ( s - 1.000 ) *     ( s - 0.500 );
  	t[2] =    4.000 * r * ( r - 0.500 ) * s * ( s - 0.500 );
  	t[3] =    4.000 *     ( r - 1.000 ) *     ( r - 0.500 ) * s * ( s - 0.500 );
  	t[4] = -  8.000 * r * ( r - 1.000 ) *     ( s - 1.000 ) *     ( s - 0.500 );
  	t[5] = -  8.000 * r * ( r - 0.500 ) * s * ( s - 1.000 );
  	t[6] = -  8.000 * r * ( r - 1.000 ) * s * ( s - 0.500 );
  	t[7] = -  8.000 *     ( r - 1.000 ) *     ( r - 0.500 ) * s * ( s - 1.000 );
  	t[8] =   16.000 * r * ( r - 1.000 ) * s * ( s - 1.000 );

  	dtdr[0] =   4.000 * ( 2.000 * r - 1.500 ) *     ( s - 1.000 ) * ( s - 0.500 );
  	dtdr[1] =   4.000 * ( 2.000 * r - 0.500 ) *     ( s - 1.000 ) * ( s - 0.500 );
  	dtdr[2] =   4.000 * ( 2.000 * r - 0.500 ) * s * ( s - 0.500 );
  	dtdr[3] =   4.000 * ( 2.000 * r - 1.500 ) * s * ( s - 0.500 );
  	dtdr[4] = - 8.000 * ( 2.000 * r - 1.000 ) *     ( s - 1.000 ) * ( s - 0.500 );
  	dtdr[5] = - 8.000 * ( 2.000 * r - 0.500 ) * s * ( s - 1.000 );
  	dtdr[6] = - 8.000 * ( 2.000 * r - 1.000 ) * s * ( s - 0.500 );
  	dtdr[7] = - 8.000 * ( 2.000 * r - 1.500 ) * s * ( s - 1.000 );
  	dtdr[8] =  16.000 * ( 2.000 * r - 1.000 ) * s * ( s - 1.000 );

  	dtds[0] =   4.000 *     ( r - 1.000 ) * ( r - 0.500 ) * ( 2.000 * s - 1.500 );
  	dtds[1] =   4.000 * r * ( r - 0.500 ) * 		( 2.000 * s - 1.500 );
  	dtds[2] =   4.000 * r * ( r - 0.500 ) * 		( 2.000 * s - 0.500 );
  	dtds[3] =   4.000 *     ( r - 1.000 ) * ( r - 0.500 ) * ( 2.000 * s - 0.500 );
  	dtds[4] = - 8.000 * r * ( r - 1.000 ) * 		( 2.000 * s - 1.500 );
  	dtds[5] = - 8.000 * r * ( r - 0.500 ) * 		( 2.000 * s - 1.000 );
  	dtds[6] = - 8.000 * r * ( r - 1.000 ) * 		( 2.000 * s - 0.500 );
  	dtds[7] = - 8.000 *     ( r - 1.000 ) * ( r - 0.500 ) * ( 2.000 * s - 1.000 );
  	dtds[8] =  16.000 * r * ( r - 1.000 ) * 		( 2.000 * s - 1.000 );

}
